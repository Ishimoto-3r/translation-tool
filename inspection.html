<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>検品リスト作成</title>

  <!-- 既存と同じ方針：Tailwind CDN（警告は出ますが動作には無関係） -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    /* リスト内スクロール禁止：全体スクロールのみ */
    .no-inner-scroll { overflow: visible !important; max-height: none !important; }
  </style>
</head>

<body class="bg-gray-50 text-gray-900">
  <!-- ===== NAV（既存プロジェクトに合わせて必要なら差し替え） ===== -->
  <nav class="tool-nav px-4 pt-4">
    <!-- ※ここは既存プロジェクトの nav をそのまま流用してください（必要なら） -->
  </nav>

  <main class="max-w-5xl mx-auto px-4 py-6">
    <div class="bg-white rounded-xl shadow p-6 space-y-6">
      <h1 class="text-xl font-bold">検品リスト作成ツール</h1>

      <!-- ===== PDF（D&D + クリック） ===== -->
      <section class="space-y-3">
        <div class="text-sm font-semibold">PDF（ドラッグ&ドロップ / クリック選択）</div>

        <label
          id="dropZone"
          class="block border-2 border-dashed rounded-lg p-6 bg-gray-50 cursor-pointer hover:bg-gray-100 transition"
        >
          <div class="text-center space-y-2">
            <div class="text-gray-700">ここにPDFをドロップ（またはクリックで選択）</div>
            <div id="fileName" class="text-xs text-gray-500">未選択</div>
          </div>
          <input id="pdfInput" type="file" accept="application/pdf" class="hidden" />
        </label>

        <!-- PDF読み取り（AI抽出）エリア：ここに型番/製品名の入力欄を配置 -->
        <div class="bg-gray-50 border rounded-lg p-4 space-y-4">
          <div class="flex items-center justify-between gap-3 flex-wrap">
            <div class="space-y-1">
              <div class="text-sm font-semibold">PDF読み取り（AI抽出）</div>
              <div class="text-xs text-gray-600">
                抽出結果を確認し、必要なものだけチェックして検品リストに反映します（初期は未チェック）。
              </div>
            </div>

            <button
              id="btnExtract"
              type="button"
              class="px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60"
            >
              PDFをAIに読み取らせる
            </button>
          </div>

          <!-- 型番 / 製品名（未入力ならPDFから自動反映される運用） -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="space-y-1">
              <label class="text-sm font-semibold">型番（未入力ならPDFから自動取得）</label>
              <input
                id="modelInput"
                type="text"
                class="w-full border rounded-lg px-3 py-2 bg-white"
              />
            </div>
            <div class="space-y-1">
              <label class="text-sm font-semibold">製品名（未入力ならPDFから自動取得）</label>
              <input
                id="productInput"
                type="text"
                class="w-full border rounded-lg px-3 py-2 bg-white"
              />
            </div>
          </div>

          <!-- 抽出結果：1列（縦並び）＋各リスト内部スクロール禁止 -->
          <div class="space-y-6">
            <div class="space-y-2">
              <div class="text-sm font-semibold">仕様</div>
              <div id="specList" class="no-inner-scroll space-y-2"></div>
            </div>

            <div class="space-y-2">
              <div class="text-sm font-semibold">動作</div>
              <div id="opList" class="no-inner-scroll space-y-2"></div>
            </div>

            <div class="space-y-2">
              <div class="text-sm font-semibold">付属品</div>
              <div id="accList" class="no-inner-scroll space-y-2"></div>
            </div>
          </div>
        </div>
      </section>

      <!-- ===== ラベル選択（選択リスト） ===== -->
      <section class="space-y-3">
        <div class="text-sm font-semibold">ラベル選択</div>
        <div class="flex flex-wrap gap-6 text-sm">
          <label class="flex items-center gap-2">
            <input id="lblLiion" type="checkbox" class="h-4 w-4" checked />
            リチウムイオン電池
          </label>
          <label class="flex items-center gap-2">
            <input id="lblLegal" type="checkbox" class="h-4 w-4" checked />
            法的対象(PSE/無線)
          </label>
        </div>

        <div class="text-xs text-gray-600">
          ※ 選択リストは「検品項目リスト」シートのA列が「選択リスト」の行のC列を表示しています（不要なものだけチェックを外す）。
        </div>

        <div id="selectList" class="no-inner-scroll space-y-2"></div>
      </section>

      <!-- ===== 生成 ===== -->
      <section class="space-y-3">
        <button
          id="btnGenerate"
          type="button"
          class="w-full md:w-auto px-5 py-3 rounded-lg bg-gray-900 text-white hover:bg-black disabled:opacity-60"
        >
          検品リストExcel生成
        </button>

        <!-- 進捗表示（最低限：動いていることがわかる） -->
        <div id="progress" class="text-sm text-gray-600 hidden">処理中…</div>
      </section>
    </div>
  </main>

  <!-- ✅ cdnjsのpdf.jsは削除（MIME不一致でブロックされる原因） -->
  <!-- ✅ inspection.js は module で読む -->
  <script type="module" src="/inspection.js"></script>
</body>
</html>
